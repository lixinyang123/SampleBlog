<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <link rel="stylesheet" href="https://fonts.xz.style/serve/inter.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@exampledev/new.css@1.1.2/new.min.css" />
    <link rel="stylesheet" href="http://cdn.bootcss.com/highlight.js/8.0/styles/monokai_sublime.min.css" />
    <link rel="stylesheet" href="https://newcss.net/theme/night.css" />

    <script src="https://cdn.jsdelivr.net/npm/marked@1.1.0/marked.min.js"></script>
    <script src="http://cdn.bootcss.com/highlight.js/8.0/highlight.min.js"></script> 
</head>
<body>
    <header>
        <h2>
            <span id="name"></span>
            &nbsp;Blog
        </h2>
    </header>

    <div id="content"></div>

    <script>
        function showArticle(name){
            var href = "/articles/" + name + ".txt";
            fetch(href,{
                method:"GET"
            }).then((res)=>{
                if(res.status==200){
                    res.text().then((text)=>{
                        document.getElementById('content').innerHTML = marked(text);
                        hljs.initHighlighting();
                    });
                }
            });
        }

        function showData(articles){
            for(var i=0;i<articles.length;i++){
                var article = document.createElement("div");

                var title = document.createElement("h2");
                title.innerText = articles[i].title;

                var desc = document.createElement("p");
                desc.innerText = articles[i].desc;

                var link = document.createElement("a");
                var btn = document.createElement("button");
                btn.innerText = "Detail";
                btn.setAttribute("onclick","showArticle('" + articles[i].file + "')");
                link.appendChild(btn);

                var hr = document.createElement("hr");

                article.appendChild(title);
                article.appendChild(desc);
                article.appendChild(link);
                article.appendChild(hr);

                document.querySelector("#content").appendChild(article);
            }
        }

        function init(){
            fetch("/config.json",{
                method:"GET"
            }).then((res)=>{
                res.json().then((config)=>{
                    document.querySelector("#name").innerText = config.name + "'s";
                    showData(config.articles);
                });
            });
        }
        
        init();
    </script>

</body>
</html>